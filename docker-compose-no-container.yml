version: "3"

services:
  apache2-multiphp:
    build:
      context: ./bin/apache2_multiphp
      dockerfile: Dockerfile
    container_name: apache2-multiphp
    restart: always
    ports:
      - "8022:22"
      - "8080:80"
      - "8081:8081"
      - "8443:443"
    links:
      - mariadb
    volumes:
      - ./data-html:/var/www/html
      - "../:/media:delegated"
      - ./history:/history
      - ./config/php-8.1/php-apache.ini:/etc/php/8.1/apache2/php.ini
      - ./config/php-8.1/php-cli.ini:/etc/php/8.1/cli/php.ini
      - ./config/php-8.1/php-fpm.ini:/etc/php/8.1/fpm/php.ini
      - ./config/php-8.1/www.conf:/etc/php/8.1/fpm/pool.d/www.conf
      - ./config/php-8.1/php-fpm.conf:/etc/php/8.1/fpm/php-fpm.conf

      - ./config/php-8.0/php-apache.ini:/etc/php/8.0/apache2/php.ini
      - ./config/php-8.0/php-cli.ini:/etc/php/8.0/cli/php.ini
      - ./config/php-8.0/php-fpm.ini:/etc/php/8.0/fpm/php.ini
      - ./config/php-8.0/www.conf:/etc/php/8.0/fpm/pool.d/www.conf
      - ./config/php-8.0/php-fpm.conf:/etc/php/8.0/fpm/php-fpm.conf

      - ./config/php-7.4/php-apache.ini:/etc/php/7.4/apache2/php.ini
      - ./config/php-7.4/php-cli.ini:/etc/php/7.4/cli/php.ini
      - ./config/php-7.4/php-fpm.ini:/etc/php/7.4/fpm/php.ini
      - ./config/php-7.4/www.conf:/etc/php/7.4/fpm/pool.d/www.conf
      - ./config/php-7.4/php-fpm.conf:/etc/php/7.4/fpm/php-fpm.conf

      - ./config/php-7.2/php-apache.ini:/etc/php/7.2/apache2/php.ini
      - ./config/php-7.2/php-cli.ini:/etc/php/7.2/cli/php.ini
      - ./config/php-7.2/php-fpm.ini:/etc/php/7.2/fpm/php.ini
      - ./config/php-7.2/www.conf:/etc/php/7.2/fpm/pool.d/www.conf
      - ./config/php-7.2/php-fpm.conf:/etc/php/7.2/fpm/php-fpm.conf

      - ./config/php-5.6/php-apache.ini:/etc/php/5.6/apache2/php.ini
      - ./config/php-5.6/php-cli.ini:/etc/php/5.6/cli/php.ini
      - ./config/php-5.6/php-fpm.ini:/etc/php/5.6/fpm/php.ini
      - ./config/php-5.6/www.conf:/etc/php/5.6/fpm/pool.d/www.conf
      - ./config/php-5.6/php-fpm.conf:/etc/php/5.6/fpm/php-fpm.conf

      - ./config/vhosts:/etc/apache2/sites-enabled
      - ./config/hosts:/etc/hosts
      - ./config/.zshrc:/home/www/.zshrc
      - ./logs/apache2:/var/log/apache2
      - ./logs/php:/var/log/php

  mariadb:
    build:
      context: "./bin/mariadb"
      dockerfile: Dockerfile
    container_name: mariadb
    restart: always
    ports:
      - "3306:3306"
    volumes:
      - ./data-mariadb:/var/lib/mysql
      - ./config/mysql/docker.cnf:/etc/mysql/mariadb.conf.d/docker.cnf
    user: mysql
    environment:
      - MYSQL_ROOT_PASSWORD=www
      - TZ=Europe/Rome

  postgres:
    build:
      context: "./bin/postgres"
      dockerfile: Dockerfile
    container_name: postgres
    restart: always
    ports:
      - "5432:5432"
    volumes:
      - ./data-postgres:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: www

